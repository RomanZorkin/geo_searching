Поиск координат по фотографии

1. Составить перечень координат Барнаула
2. Загрузить панорамы Барнаула
3. Разрезать фото на более маленькие
4. Найти фото на которых площадь неба и дороги более 50%
5. Сформировать структуру датасета (фото -> классы геозон)

6


# Общий подход к созданию датасета

Датасет будет построен на базе панорамных снимков улиц GOOGLE MAPS

Датасет создается для определенной географической области. Первичный датасет задан для Барнаула. 
Если получиться планирую расширить до 4 городов (2 в России и 2 не в России) для формования иерархической классификации Страна -> Регион/Город -> geocell

Изначально задается географическая область - прямоугольник. Нижний левый угол - начало и верхний правый угол - конец.
Далее формируется матрица координат этого прямоугольника. Шаг между ячейками задается отдельно для долготы и широты в метрах.
Переход от градусов к метрам для первичного датасета задан в виде жестких коэффициентов. Эти коэффициенты не применимы для иных географически областей в связи со смещением широты. Для разных широт в одно градусе содержится различное кол-во км.


Первоначально шаг задан в 20 метров. Это значение подбирается в ручную. 

Для получения снимков использован сервис "streetview" https://github.com/robolyst/streetview. 
Загрузка фотографий происходит в 2 этапа. 
Первично для заданной координаты из google maps извлекается список уникальных названий панорамных снимков смежных с указанной координатой. Если задать маленький шаг между координатами будут получены списки с часто повторяющимися снимками. Если шаг будет слишком большой часть снимков могут быть упущены.
Далее по уникальному имени панорам происходит загрузка изображения.

Постобработка полученных изображений
- для расширения датасета возможно попробовать использую автоэнкодеры создать зимние, весенние, осенние снимки


# 1. Подготовка списка координат Барнаул

В качестве первичного расположения был выбран Барнаул. Для этого города был задан прямоугольник в пределах
нижний левый угол
start_lat = 53.291315
start_lon = 83.590640
верхний правый угол
stop_lat = 53.399023
stop_lon = 83.805205

Шаг был выбран в 20 метров - примерно на таком расстоянии список панорамных снимков не пересекается и не пропускается

Далее простым циклом перебора координат с заданным шагом для локации Барнаул было получено 433922 координат. 

Список координат составлен. Теперь возможно для каждой координаты получить лейблы с данными о помаранных снимках.
Пример списка лейблов:
```
[Panorama(pano_id='suorKTZrkJTaGhUUlgkwIg', lat=53.32822141869757, lon=83.68271865044099, heading=280.7651977539062, pitch=90.88703918457031, roll=359.2576599121094, date='2012-07'),
 Panorama(pano_id='4sFaZfPw9WekRt7CLTFpEw', lat=53.32811947079741, lon=83.6827456451473, heading=101.4230499267578, pitch=89.6850357055664, roll=0.5733432173728943, date=None)]
```
Эта процедура занимает много времени. Google colab выдает среднюю скорость 4-5 координат в секунду, общее время выполнения может достигать 30 часов.
Для ускорения процесса выполнения одновременно было запущено несколько ноутбуков. Полученные данные объединены и очищены от дублирующих значений.

На данном этапе есть потенциал ускорения работы сервиса (распараллеливать процессы, найти иной сервис)
